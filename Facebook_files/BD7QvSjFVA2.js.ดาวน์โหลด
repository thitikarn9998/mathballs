if (self.CavalryLogger) { CavalryLogger.start_js(["ZKqvs"]); }

__d("NotificationBeeperItemCloseButton.react",["cx","fbt","React","XUIAbstractGlyphButton.react"],(function(a,b,c,d,e,f,g,h){__p&&__p();a=function(a){"use strict";babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){var a=h._("\u0e1b\u0e34\u0e14");return b("React").createElement(b("XUIAbstractGlyphButton.react"),babelHelpers["extends"]({},this.props,{className:"_3soc",title:a,label:a,labelIsHidden:!0}))};return c}(b("React").Component);e.exports=a}),null);
__d("NotificationURI",["BusinessURI.brands","URI","VideoPermalinkURI","isDevelopersURI","isFacebookURI"],(function(a,b,c,d,e,f){__p&&__p();a={localize:function(a){__p&&__p();try{a=b("BusinessURI.brands")(a)}catch(b){return a.toString()}var c=a.getSubdomain();c=a.getUnqualifiedURI().getQualifiedURI().setSubdomain(c);if(b("isDevelopersURI")(a)){a=c.getDomain().split(".");a.length>=2&&(a.splice(-2,1,"facebook")[0]==="workplace"&&c.setDomain(a.join(".")))}return c.toString()},snowliftable:function(a){if(!a)return!1;a=new(b("URI"))(a);var c=a.getQueryData();return b("isFacebookURI")(a)&&(b("VideoPermalinkURI").isValid(a)||"fbid"in c)},isVaultSetURI:function(a){return this._areEquals(a,"/ajax/vault/sharer_preview.php")},isAlbumDraftRecoveryDialogURI:function(a){return this._areEquals(a,"/ajax/photos/upload/overlay/")},isQuicksilverURI:function(a){return this._areEquals(a,"/games/quicksilver/spotlight/")},isDirectURI:function(a){return this._startsWith(a,"/direct/")},isIGAccountCreationURI:function(a){return this._areEquals(a,"/ads/growth/aymt/instagram/account-creation-dialog/")},_areEquals:function(a,c){if(!a)return!1;a=new(b("URI"))(a);return b("isFacebookURI")(a)&&a.getPath()===c},_startsWith:function(a,c){if(!a)return!1;a=new(b("URI"))(a);return b("isFacebookURI")(a)&&a.getPath().startsWith(c)}};e.exports=a}),null);
__d("XLiveVideoLoadController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/live/video/load/",{video_id:{type:"FBID",required:!0}})}),null);
__d("notificationListRendererIsStoryOnlyLiveVideoNotification",[],(function(a,b,c,d,e,f){"use strict";function a(a){a=a.renderer_data;return a==null?!1:a.__typename==="LiveVideoNotificationRendererData"&&!!a.bucket_data}e.exports=a}),null);
__d("notificationListRendererOpenNotification",["AsyncRequest","Bootloader","NotificationURI","PageTransitions","URI","VideoChainingCaller","XLiveVideoLoadController","notificationListRendererIsStoryOnlyLiveVideoNotification"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,c){__p&&__p();var d=c.renderer_data;if(d==null)return;if(!b("notificationListRendererIsStoryOnlyLiveVideoNotification")(c)&&(a.metaKey||a.ctrlKey||a.button===1))return;if(d.__typename==="LiveVideoNotificationRendererData"){a.preventDefault();d=b("XLiveVideoLoadController").getURIBuilder().setFBID("video_id",d.video_id).getURI();d=new(b("AsyncRequest"))(d).setHandler(function(d){d.payload?g(a,c):b("PageTransitions").go(c.url)});d.send()}}function g(a,b){var c=b.renderer_data;if(c==null)return;c.bucket_data?h(a,c):c.can_render_in_tahoe&&i(a,c,b)}function h(a,c){b("Bootloader").loadModules(["FBStoriesLiveNotificationHandler"],function(a){a.renderLiveStory(c)},"notificationListRendererOpenNotification")}function i(a,c,d){b("Bootloader").loadModules(["TahoeController"],function(a){var e=b("NotificationURI").localize(new(b("URI"))(d.url)),f=c.video_channel_caller;a.openFromVideoLink(new(b("URI"))(e),{channelID:c.video_channel_id,caller:f?(a=b("VideoChainingCaller"))!=null?a[f]:a:null})},"notificationListRendererOpenNotification")}e.exports=a}),null);
__d("NotificationBeeperItemContents.react",["cx","invariant","Animation","AsyncRequest","Bootloader","FBProfilePhotoShadow.react","Image.react","ImageBlock.react","NotificationBeeperItemCloseButton.react","NotificationInterpolator","NotificationURI","NotificationUserActions","React","ReactDOM","TextWithEntities.react","Timestamp.react","URI","notificationListRendererOpenNotification"],(function(a,b,c,d,e,f,g,h){__p&&__p();a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){__p&&__p();var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.isLiveVideo=null,d.onClick=function(a){__p&&__p();d.$1();d.props.onHide();if(a.button===1||a.altKey||a.ctrlKey||a.metaKey||a.shiftKey)return;var c=d.props.notification;b("notificationListRendererOpenNotification")(a,c);if(a.isDefaultPrevented()===!0)return;var e=c.primerAttributes;if(e&&(e.rel==="async"||e.rel==="async-post")){var f=new(b("AsyncRequest"))(e.ajaxify||c.url);e.rel==="async-post"&&f.setMethod("POST");f.send();a.preventDefault()}else e&&e.rel==="theater"?(a.persist(),b("Bootloader").loadModules(["PhotoSnowlift"],function(b){b.bootstrap(e.ajaxify||c.url,a.currentTarget)},"NotificationBeeperItemContents.react"),a.preventDefault()):e&&(e.rel==="dialog"||e.rel==="dialog-post")&&(b("Bootloader").loadModules(["AsyncDialog"],function(b){b.bootstrap(e.ajaxify||c.url,a.currentTarget,"dialog")},"NotificationBeeperItemContents.react"),a.preventDefault())},d.onClose=function(){d.$1(),d.props.onHide()},c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.$1=function(){b("NotificationUserActions").markNotificationsAsRead([this.props.notification.alert_id])};d.$2=function(){new(b("Animation"))(b("ReactDOM").findDOMNode(this.refs.inner)).from("opacity","0").to("opacity","1").duration(200).go()};d.$3=function(){var a=this.$4();a=JSON.parse(a);return a.content_id};d.$5=function(){if(this.isLiveVideo===null){var a=this.$4();this.isLiveVideo=a.indexOf("live_video")!==-1}return!!this.isLiveVideo};d.$4=function(){return this.props.notification.tracking||"{}"};d.componentDidMount=function(){var a=this;this.props.onReadyToHide(this.props.notification.alert_id);this.$5()&&b("Bootloader").loadModules(["VideoPlayerMetaData","PhotoSnowliftVideoNode"],function(b,c){c=a.$3();c&&b.genVideoData(c)},"NotificationBeeperItemContents.react")};d.componentDidUpdate=function(a){(a.notification.alert_id!==this.props.notification.alert_id||a.notification.creation_time!==this.props.notification.creation_time)&&(this.$2(),this.props.onReadyToHide(this.props.notification.alert_id))};d.render=function(){var a=this.props.notification;a.title!==null||h(0,17664,a.notif_type);var c=a.thumbnail?a.thumbnail.uri:null,d=a.icon?a.icon.uri:null,e=b("NotificationURI").localize(new(b("URI"))(a.url));return b("React").createElement("div",{ref:"inner",className:this.props.className},b("React").createElement(b("NotificationBeeperItemCloseButton.react"),{onClick:this.onClose}),b("React").createElement("a",{href:e,onClick:this.onClick,className:"_3soi"},b("React").createElement(b("ImageBlock.react"),{className:"_3soj",spacing:"medium"},b("React").createElement(b("FBProfilePhotoShadow.react"),{className:"_2yt7"},b("React").createElement(b("Image.react"),{src:c,className:"_3sok"+(c?"":" hidden_elem")})),b("React").createElement("div",{className:"_3sol"},b("React").createElement(b("TextWithEntities.react"),{renderEmoticons:!0,renderEmoji:!0,interpolator:b("NotificationInterpolator"),ranges:a.title.ranges,aggregatedranges:a.title.aggregated_ranges,text:a.title.text}),b("React").createElement(b("ImageBlock.react"),{className:"_3som"},b("React").createElement(b("Image.react"),{className:"_1x8t"+(d?"":" hidden_elem"),src:d}),b("React").createElement(b("Timestamp.react"),{time:a.timestamp.time,text:a.timestamp.text,verbose:a.timestamp.verbose}))))))};return c}(b("React").Component);e.exports=a}),null);
__d("NotificationBeeperItem.react",["cx","CSSFade","NotificationBeeperConst","NotificationBeeperItemContents.react","NotificationBeeperItemRenderersList","React","ReactDOM","Style","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("NotificationBeeperConst").FADE_OUT_LENGTH;a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.state={encounteredException:!1,fadedIn:!1,hidden:!1},c.$3=function(){c.setState({hidden:!0})},b)||babelHelpers.assertThisInitialized(c)}var d=c.prototype;d.componentDidCatch=function(){this.props.onReadyToHide(this.props.notification.alert_id),this.setState(function(a){return babelHelpers["extends"]({},a,{encounteredException:!0})})};d.componentDidMount=function(){var a=this;b("setTimeoutAcrossTransitions")(function(){a.setState({fadedIn:!0})},50);this.props.onInserted(this.props.notification.alert_id)};d.componentWillUnmount=function(){this.$1&&this.$1.cancel()};d.render=function(){var a=this;if(this.state.encounteredException)return null;var c=this.props.notification,d=c.renderer_data;c=c.tracking;d=this.$4(d);return b("React").createElement("li",{className:this.state.hidden?"hidden_elem":"",ref:function(b){return a.$2=b},"data-gt":c},b("React").createElement(d,{className:"_3sod"+(this.state.fadedIn?" _3soe":""),notification:this.props.notification,onHide:this.$3,onReadyToHide:this.props.onReadyToHide,onPreventHide:this.props.onPreventHide}))};d.componentDidUpdate=function(a,c,d){if(!this.$2)return;a=b("ReactDOM").findDOMNode(this.$2);if(!a)return;this.props.fadingOut?(this.$1=b("CSSFade").hide(a,{callback:this.$3,duration:h}),a.style.transitionDuration="0ms"):(this.$1&&(this.$1.cancel(),this.$1=void 0),b("Style").set(a,"opacity","1"))};d.$4=function(a){return a&&a.__typename==="LiveVideoNotificationRendererData"&&a.video_id==null?b("NotificationBeeperItemContents.react"):b("NotificationBeeperItemRenderersList")[a&&a.__typename]||b("NotificationBeeperItemContents.react")};return c}(b("React").Component);e.exports=a}),null);
__d("NotificationImpressions",["AsyncSignal","NotificationTokens","URI"],(function(a,b,c,d,e,f){var g="/ajax/notifications/impression.php";function a(a,c){var d={ref:c};b("NotificationTokens").untokenizeIDs(a).forEach(function(a,b){d["alert_ids["+b+"]"]=a});new(b("AsyncSignal"))(new(b("URI"))(g).getQualifiedURI().toString(),d).send()}e.exports={log:a}}),null);
__d("NotificationBeeper.react",["cx","Arbiter","ChannelConstants","FacebookWebNotificationsSubscription","NotificationBeeperConst","NotificationBeeperItem.react","NotificationConstants","NotificationImpressions","NotificationSound","NotificationUpdates","NotificationUserActions","NotifTestIDs","React","SubscriptionsHandler","clearTimeout","setTimeoutAcrossTransitions","shield"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("NotificationBeeperConst").ACTIVE_DELAY_LONG,i=b("NotificationBeeperConst").BeepStates,j=b("NotificationBeeperConst").FADE_OUT_LENGTH,k=b("NotificationBeeperConst").IDLE_DELAY,l="beeper";a=b("NotificationConstants").PayloadSourceType;var m=a.CLIENT,n=a.OTHER_APPLICATION;c=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){__p&&__p();var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.state={beeps:{},fading:!1,hovering:!1,soundEnabled:d.props.soundEnabled},d.onMouseEnter=function(){d.$2&&b("clearTimeout")(d.$2);var a=[],c=d.state.beeps;Object.keys(c).forEach(function(b){c[b].state!=i.PENDING?a.push(b):c[b].state=i.RENDERED});b("NotificationUserActions").markNotificationsAsSeen(a);d.setState({hovering:!0,fading:!1,beeps:c})},d.onMouseLeave=function(){d.$5(h),d.setState({hovering:!1})},d.$6=function(a){d.state.hovering||d.$5(),d.state.soundEnabled&&d.state.beeps[a].shouldPlaySound&&(d.$3||(d.$3=new(b("NotificationSound"))(d.props.soundPath)),d.$3.play(a)),d.props.shouldLogImpressions&&b("NotificationImpressions").log([a],l)},d.onReadyToHide=function(a,b){d.setState(function(b){var c=babelHelpers["extends"]({},b.beeps);c[a]=babelHelpers["extends"]({},c[a],{state:i.READY_TO_HIDE});return babelHelpers["extends"]({},b,{beeps:c})}),d.$2||d.$5(b)},d.$8=function(a){d.setState(function(b){var c=babelHelpers["extends"]({},b.beeps);c[a]=babelHelpers["extends"]({},c[a],{state:i.RENDERED});return babelHelpers["extends"]({},b,{beeps:c})})},d.$7=function(){d.$2=null,d.setState(function(a){var b=babelHelpers["extends"]({},a.beeps);Object.keys(b).forEach(function(a){b[a].state==i.READY_TO_HIDE&&(b[a]=babelHelpers["extends"]({},b[a],{state:i.FADING_OUT}))});return babelHelpers["extends"]({},a,{beeps:b,fading:!0})}),b("setTimeoutAcrossTransitions")(b("shield")(d.$9,babelHelpers.assertThisInitialized(d)),j)},d.$9=function(){__p&&__p();if(!d.state.fading)return;d.setState(function(a){var b=babelHelpers["extends"]({},a.beeps);Object.keys(b).forEach(function(a){b[a].state==i.FADING_OUT&&delete b[a]});return babelHelpers["extends"]({},a,{beeps:b,fading:!1})});b("setTimeoutAcrossTransitions")(function(){d.setState(function(a){var b=babelHelpers["extends"]({},a.beeps);Object.keys(b).forEach(function(a){b[a].state==i.PENDING&&(b[a]=babelHelpers["extends"]({},b[a],{state:i.RENDERED}))});return babelHelpers["extends"]({},a,{beeps:b})})})},c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.UNSAFE_componentWillMount=function(){__p&&__p();var a=this,c=new(b("SubscriptionsHandler"))();c.addSubscriptions(b("NotificationUpdates").subscribe("update-notifications",function(b,c){if(c.payloadsource===n||c.payloadsource===m){b=c.nodes;b&&b.length&&a.handleBeepChanges(a.$4(b))}}),b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("notif_sound_pref_changed"),function(b,c){a.setState({soundEnabled:c.obj.enabled})}));c.addSubscriptions(b("FacebookWebNotificationsSubscription").subscribe({event:"NEW_BEEPER",callback:function(b){var c=b.notification;b=b.should_play_sound;if(c!==null){var d;a.handleBeepChanges((d={},d[c.alert_id]={notification:c,shouldPlaySound:b},d))}}}));this.$1=c;b("Arbiter").inform("NotificationBeeper/mounted",null,"persistent")};d.componentWillUnmount=function(){this.$1&&this.$1.release(),this.$1=null};d.$5=function(a){this.$2&&b("clearTimeout")(this.$2),this.$2=b("setTimeoutAcrossTransitions")(b("shield")(this.$7,this),a==null?k:a)};d.handleBeepChanges=function(a){var b=this.state.fading?i.PENDING:i.RENDERED,c=!1,d=babelHelpers["extends"]({},this.state.beeps);Object.keys(a).reverse().forEach(function(e){var f=a[e],g=d[e];(!g||g.notification.alert_id!==f.notification.alert_id||g.notification.creation_time!==f.notification.creation_time)&&(g&&(c=!0,delete d[e]),d[e]=babelHelpers["extends"]({},f,{state:b}))});c&&this.$5();this.setState({beeps:d})};d.render=function(){var a=this,c=this.state.beeps,d=[];Object.keys(c).reverse().forEach(function(e){var f=c[e];if(f.state==i.PENDING)return;d.push(b("React").createElement(b("NotificationBeeperItem.react"),{key:e,fadingOut:a.state.fading&&f.state==i.FADING_OUT,notification:f.notification,onInserted:a.$6,onReadyToHide:a.onReadyToHide,onPreventHide:a.$8}))},this);var e=d.length>0;e=(e?"":"hidden_elem")+" _50d1";return b("React").createElement("ul",{ref:"container",className:e,"data-gt":this.props.tracking,"data-testid":b("NotifTestIDs").BEEPER_LIST,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},d)};d.$4=function(a){return a.reduce(function(a,b){a[b.alert_id]={notification:b,shouldPlaySound:!1};return a},{})};return c}(b("React").Component);e.exports=c}),null);
__d("NotificationBeeperContainer",["NotificationBeeper.react","React","ReactDOM"],(function(a,b,c,d,e,f){a={renderBeeper:function(a,c){b("ReactDOM").render(b("React").createElement(b("NotificationBeeper.react"),a),c)}};e.exports=a}),null);
__d("LiveVideoBeeperItemContents.react",["BootloadOnRender.react","JSResource","LazyComponent.react","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){return b("React").createElement(b("BootloadOnRender.react"),{loader:b("JSResource")("LiveVideoBeeperItemContentsImpl.react").__setRef("LiveVideoBeeperItemContents.react"),placeholder:b("React").createElement("div",null),component:b("React").createElement(b("LazyComponent.react"),babelHelpers["extends"]({},this.props,{ref:"itemContents"}))})};return c}(b("React").Component);e.exports=a}),null);
__d("XWorkUserSettingsUpdateController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/work/user_settings/",{})}),null);
__d("DockNubs",["AsyncRequest","CSS","WorkUserSettings","XWorkUserSettingsUpdateController"],(function(a,b,c,d,e,f){__p&&__p();var g="hidden_elem",h=b("WorkUserSettings").hideDock,i=null,j=[],k={init:function(a){i=a,k.registerSubscriber(k._updateCssClasses)},isVisible:function(){return!h},registerSubscriber:function(a){j.push(a);a(h);return{unsubscribe:function(){k._unregisterSubscriber(a)}}},_unregisterSubscriber:function(a){j=j.filter(function(b){return b!==a})},_updateSubscribers:function(){j.forEach(function(a){return a(h)})},toggleVisibility:function(){if(!i)return;h=!h;this._saveVisibilityPreferences(h);this._updateSubscribers()},_saveVisibilityPreferences:function(a){var c=b("XWorkUserSettingsUpdateController").getURIBuilder().getURI();new(b("AsyncRequest"))(c).setMethod("POST").setData({hide_dock:a}).send()},_updateCssClasses:function(){if(!i)return;h?b("CSS").addClass(i,g):b("CSS").removeClass(i,g)}};e.exports=k}),null);
__d("KeyboardShortcutFlyout.react",["cx","fbt","Bootloader","KeyboardShortcuts","React"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.state={shortcutInfos:b("KeyboardShortcuts").getShortcutInfos()},c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.render=function(){return b("React").createElement("div",{className:"_yqu _2ph_ _2pim"},b("React").createElement("table",{className:"_67br"},b("React").createElement("tbody",null,this.$2())))};d.componentDidMount=function(){var a=this;this.$1=b("KeyboardShortcuts").subscribe(["cleanup","token_added"],function(){a.setState({shortcutInfos:b("KeyboardShortcuts").getShortcutInfos()})});b("Bootloader").loadModules(["KeyEventTypedLogger"],function(a){new a().setAction("key_shortcut_flyout_shown").log()},"KeyboardShortcutFlyout.react")};d.componentWillUnmount=function(){b("KeyboardShortcuts").unsubscribe(this.$1)};d.$2=function(){return this.state.shortcutInfos.length?this.state.shortcutInfos.map(this.$3):h._("\u0e44\u0e21\u0e48\u0e21\u0e35\u0e17\u0e32\u0e07\u0e25\u0e31\u0e14\u0e1a\u0e19\u0e2b\u0e19\u0e49\u0e32\u0e19\u0e35\u0e49")};d.$3=function(a,c){return b("React").createElement("tr",{key:"shortcut_info_"+c,className:"_3-12"},b("React").createElement("th",{className:"_2pin _52ju"},a.displayKeys.map(function(c,a){return b("React").createElement("span",{className:"_3-28 _2e42 _653d _52jv",key:a},c)})),b("React").createElement("td",{className:"_2pin _2pii"},a.description))};return c}(b("React").PureComponent);e.exports=a}),null);
__d("NubController",["csx","ArbiterMixin","Dock"],(function(a,b,c,d,e,f,g){__p&&__p();function a(){}Object.assign(a.prototype,b("ArbiterMixin"),{init:function(a){this.el=a;this.nubButton=a.querySelector(".fbNubButton");this.closeButton=a.querySelector("._2dv8");b("Dock").registerNubController(a,this);this.closeButton&&this.closeButton.addEventListener("click",this.hide.bind(this));return this},buttonContentChanged:function(){this.inform("nub/button/content-changed")},flyoutContentChanged:function(){this.inform("nub/flyout/content-changed")},hide:function(){b("Dock").hide(this.el)},show:function(){b("Dock").show(this.el)}});e.exports=a}),null);
__d("ReactNub",["csx","DOM","Focus","NubController","Parent","React","ReactDOM","getActiveElement"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(c,d){__p&&__p();var e;e=a.call(this)||this;e.$ReactNub4=function(){b("ReactDOM").unmountComponentAtNode(e.$ReactNub1),b("Focus").set(e.$ReactNub3),e.$ReactNub3!==b("getActiveElement")()&&b("Focus").set(e.nubButton)};e.$ReactNub5=function(){e.$ReactNub3=b("getActiveElement")();var a=e.$ReactNub2;b("ReactDOM").render(b("React").createElement(a,{onContentChanged:e.flyoutContentChanged.bind(babelHelpers.assertThisInitialized(e))}),e.$ReactNub1);b("Focus").set(e.closeButton)};e.$ReactNub1=c;e.$ReactNub2=d;d=b("Parent").bySelector(c,"._50-v");a.prototype.init.call(babelHelpers.assertThisInitialized(e),d);b("DOM").empty(c);e.subscribe("hide",e.$ReactNub4);e.subscribe("show",e.$ReactNub5);return e}return c}(b("NubController"));e.exports=a}),null);
__d("PYMKFriendingAction",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({IMPRESSION:"impression",MAKE:"make",ACCEPT:"accept",MAKE_BLOCK:"make_block",MAKE_ERROR:"make_error",MAKE_WARN:"make_warn",ACCEPT_ERROR:"accept_error",REJECT:"reject",REJECT_ERROR:"reject_error",HIDE:"hide",HIDE_ERROR:"hide_error",CANCEL:"cancel",CANCEL_ERROR:"cancel_error",MARK_SPAM:"mark_spam",MARK_SPAM_ERROR:"mark_spam_error",UNMARK_SPAM:"unmark_spam",UNMARK_SPAM_ERROR:"unmark_spam_error"})}),null);
__d("XPymkFunnelLoggingController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/pymk/funnel_logging/",{event_ts:{type:"Int",required:!0},query_id:{type:"Int"},candidate_id:{type:"Int"},signature:{type:"Int"},loc:{type:"String",required:!0},ref:{type:"String"},action:{type:"Enum",required:!0,enumType:1}})}),null);
__d("PymkFunnelLogger",["AsyncRequest","DOMQuery","PYMKFriendingAction","XPymkFunnelLoggingController"],(function(a,b,c,d,e,f){__p&&__p();a={setupListeners:function(a,b,c,d,e){this._setupForSingleElement(a,b,c,"add"),this._setupForSingleElement(a,b,d,"click"),this._setupForSingleElement(a,b,e,"click")},logImpression:function(a,c,d){this._logEvent(a,b("PYMKFriendingAction").IMPRESSION,c,d)},logXOut:function(a,b,c){this._logEvent(a,"hide",b,c)},_logEvent:function(a,c,d,e){a=b("XPymkFunnelLoggingController").getURIBuilder().setInt("candidate_id",a).setInt("signature",d).setInt("event_ts",Math.floor(Date.now()/1e3)).setEnum("action",c).setString("loc",e).getURI();new(b("AsyncRequest"))(a).setMethod("POST").send()},_setupForSingleElement:function(a,c,d,e){Event.listen(d,"click",function(d){d=a.getAttribute("data-signature");var f=b("DOMQuery").find(a,"input.friendBrowserID");f=parseInt(f.value,10);this._logEvent(f,e,d,c)}.bind(this))}};e.exports=a}),null);
__d("XFriendRequestIHEventLoggingController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/requests/interaction_history_logging/",{target_id:{type:"FBID",required:!0},log_event:{type:"String",required:!0}})}),null);
__d("FriendRequestIHEventLogger",["AsyncRequest","Event","XFriendRequestIHEventLoggingController"],(function(a,b,c,d,e,f){__p&&__p();a={setupJewelListeners:function(a,b,c){this._setupForJewelSingleElement(a,b,"click"),c&&this._setupForJewelSingleElement(a,c,"click")},logImpression:function(a){this._logEvent(a,"impression")},_logEvent:function(a,c){if(isNaN(a))return;a=b("XFriendRequestIHEventLoggingController").getURIBuilder().setFBID("target_id",a).setString("log_event",c).getURI();new(b("AsyncRequest"))(a).setMethod("POST").send()},_setupForJewelSingleElement:function(a,c,d){b("Event").listen(c,"click",function(b){b=a.getAttribute("id");if(b==null)return;b=b.substring(0,b.length-6);this._logEvent(b,d)}.bind(this))}};e.exports=a}),null);
__d("FriendRequestHowFound",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({ADD_FRIEND_PROTILE_BUTTON:"add_friend_protile_button",ADDFRIEND_DOT_PHP:"addfriend",AIM_IMPORTER:"aim_importer",API:"api",API_CONTACTS_UPLOAD:"api_contacts_upload",BROWSE:"browse",CALL_LOG:"call_log",CI_BACKGROUND:"ci_bkg",CI_CONTINUOUS:"ci_continuous",CI_FRIENDS_SUGGESTION:"ci_friends_suggestion",CI_PYMK:"ci_pymk",CI_PYMK_NUX:"ci_pymk_nux",CI_PYMK_READ:"ci_pymk_read",CI_PYMK_UPLOAD:"ci_pymk_upload",CI_SOFTMATCH_PYMK:"ci_softmatch_pymk",CLASSMATE_SEARCH:"classmate_search",CONTACT_CARD:"contact_card",CONTACT_IMPORTER:"friend_finder",CONTACT_IMPORTER_KAIOS:"contact_importer_kaios",CONTACT_IMPORTER_NUX:"friend_finder_nux",CONTACT_IMPORTER_READ:"friend_finder_read",CONTACT_IMPORTER_UPLOAD:"friend_finder_upload",CONTACT_SUGGEST_FRIEND:"contact_suggest_friend",CONTACTS_PEOPLE:"contacts_people",CONTEXTUAL_PROFILE_GROUPS:"contextual_profile_groups",CONTEXTUAL_PROFILE_HEADER:"contextual_profile_header",CONTEXTUAL_PROFILE_MEET_NEW_FRIENDS:"contextual_profile_meet_new_friends",CONTEXTUAL_PROFILE_PEOPLE_DISCOVERY:"contextual_profile_people_discovery",COWORKER_SEARCH:"coworker_search",CRISIS:"crisis",DATA_CLEANUP:"data_cleanup",DISCOVER_FEED:"discover_feed",EMAIL:"email",EMPTY_FEED:"empty_feed",ENTITY_CARDS:"entity_cards",ESCAPE_HATCH:"escape_hatch",EVENT_GYMK:"event_gymk",EXTERNAL_CONVERT:"external_convert",FAMILY_REQUEST:"family_request",FAMILY_SUGGEST:"family_suggest",FEED_CONTEXT:"feed_context",FEED_FRIENDABLE_HEADER:"feed_friendable_header",FEED_PYMK:"feed_pymk",FRIEND_BROWSER:"friend_browser",FRIEND_BROWSER_FIND_FRIENDS:"friend_browser_ff",FRIEND_BROWSER_NUX:"friend_browser_nux",FRIEND_BROWSER_SEARCH:"friend_browser_s",FRIEND_BROWSER_WELCOME_DASH:"friend_browser_wd",FRIEND_CENTER_FRIENDS:"friend_center_friends",FRIEND_CENTER_OUTGOING_REQ:"friend_center_outgoing_req",FRIEND_CENTER_REQUESTS:"friend_center_requests",FRIEND_CENTER_SEARCH:"friend_center_search",FRIEND_LIST_PROFILE:"friend_list_profile",FRIENDING_CARD:"friending_card",FRIENDING_CHECKUP_EVENTS:"friending_checkup_events",FRIENDING_CHECKUP_IG:"friending_checkup_ig",FRIENDING_CHECKUP_MESSENGER:"friending_checkup_messenger",FRIENDING_CHECKUP_POSTS:"friending_checkup_posts",FRIENDING_RADAR:"friending_radar",FRIENDING_TAB_UPSELL:"friending_tab_upsell",FRIENDS_HOME_FALLBACK:"friends_home_fallback",FRIENDS_HOME_FRIENDS:"friends_home_friends",FRIENDS_HOME_MAIN:"friends_home_main",FRIENDS_HOME_SUGGESTIONS:"friends_home_suggestions",FRIENDSHAKE:"friendshake",GRIFFIN_TAB:"griffin_tab",GROUP_COMMERCE:"group_commerce",GROUP_MEMBER_BIO_DIALOG:"group_member_bio_dialog",GROUP_MEMBER_LIST:"group_member_list",GROUP_MEMBERS:"group_members",GROUPS_MEMBER_LIST:"groups_member_list",GROUPS_MEMBER_PROFILE:"groups_member_profile",HOVERCARD:"hovercard",HOVERCARD_PYMK:"hovercard_pymk",INSTAGRAM_CONTACT_IMPORTER:"instagram_contact_importer",INTERN_PROFILE:"intern_profile",INVITATION:"friend_invitation",INVITE_MATCH:"invite_existing_user",INVITE_MERGE:"merge_via_invite",IORG_TOPUP:"iorg_topup",JAPAN_MOBILE_INVITE:"japan_mobile_invite",JOB_CONNECT_SEARCH:"job_connect_search",KEYWORD_SEARCH:"keyword_search",MEDLEY:"medley",MEMORIAL_CONTACT_TOOLS:"memorial_contact_tools",MERGE:"merge",MESSAGE:"message",MESSENGER_THREADVIEW_BANNER:"messenger_threadview_banner",MSITE:"friend_msite",MY_QR_CODE:"my_qr_code",NEARBY_FRIENDS:"nearby_friends",NETEGO_FRIEND_REQUESTS:"netego_friend_requests",NETEGO_PYMK:"netego_pymk",NETEGO_SUGGEST_GROUP_FRIENDS:"netego_suggest_group_friends",NEWSFEED:"newsfeed",NULLSTATE_SEARCH_PYMK_UPSELL:"nullstate_search_pymk_upsell",OTHER:"friend_other",PAIR_SEARCH:"pair_search",PARENT_KID:"parent_kid",PHOTO_TAG:"photo_tag",PIYS:"people_in_your_school",PROFILE_BROWSER:"profile_browser",PROFILE_BROWSER_EVENTS:"profile_browser_events",PROFILE_BUTTON:"profile_button",PROFILE_CHANNEL_FOLLOWERS:"profile_channel_followers",PROFILE_DISCOVERY_LIST:"profile_discovery_list",PROFILE_FRIENDS_BOX:"friends_box",PROFILE_FRIENDS_TAB:"profile_friends",PROFILE_INTENT_BANNER:"profile_discovery_intent_banner",PROFILE_INTRODUCTION:"profile_introduction",PROFILE_LIST:"profile_list",PROFILE_SHARE:"profile_share",PYMK:"people_you_may_know",PYMK_EXPERIMENT_MEGAPHONE_EF:"pymk_experiment_megaphone_ef",PYMK_FALLBACK:"pymk_fallback",PYMK_FRIENDS_TAB:"pymk_friends_tab",PYMK_MEGAPHONE:"pymk_megaphone",PYMK_MEGAPHONE_SCALABLE_EF:"pymk_megaphone_scalable_ef",PYMK_PUSH_NOTIF:"pymk_push_notif",PYMK_SIDESHOW:"pymk_sideshow",PYMK_STICKY_MEGAPHONE_EF:"pymk_sticky_megaphone_ef",PYMK_TIMELINE_CHAIN:"pymk_timeline_chain",PYMK_UPSELL:"pymk_upsell",QRCODE_ACTIONSHEET:"qrcode_actionsheet",QUICK_FRIENDING:"quick_friending",REACTION_PIVOTS:"reaction_pivots",RECENT_FRIENDSHIPS_MEGAPHONE:"recent_friendships_megaphone",REMINDERS:"reminders",REQS_MAIN_PYMK:"requests_page_pymk",REQUESTS_JEWEL:"requests_jewel",RUN_OLD_PATH:"run_old_path",SEARCH:"search",SEARCH_CHAINED_PYMK:"search_chained_pymk",SGM:"sgm",SHORTCUT:"shortcut",SMS:"sms",SPOTLIGHT_PYMK:"spotlight_pymk",SUGGESTION:"friend_suggestion",TEST:"test",TICKER:"ticker",TIMELINE_COLLECTIONS_PYMK:"timeline_collections_pymk",TIMELINE_FRIENDS_COLLECTION:"timeline_friends_collection",TIMELINE_FRIENDS_PAGELET:"timeline_friends_pagelet",TIMELINE_PYMK:"timeline_pymk",TIMELINE_UNIT:"timeline_unit",TWITTER_IMPORTER:"twitter_importer",UFI_COMMENT:"comment",VERTEX:"vertex",WEB_SEARCH:"web_search",WELCOME_FEED_OUTGOING_UNIT:"welcome_feed_outgoing_unit",WHITEHAT_FBDL:"whitehat_fbdl",WIZARD_CLASSMATES_COWORKERS:"wizard_classmates_coworkers",WIZARD_IMPORTERS:"wizard_importers",WIZARD_SEARCH:"wizard_search",WIZARD_SEARCH_PYMK:"wizard_search_pymk"})}),null);
__d("WebFriendingRequests",["Arbiter","DOM","Event","FriendRequestHowFound","FriendRequestIHEventLogger","MarauderLogger","PymkFunnelLogger","Vector","debounceCore"],(function(a,b,c,d,e,f){__p&&__p();a={init:function(a,c){__p&&__p();this._pymkBox=a;this._lastPymkSeen=-1;this._recordPYMKImpression();b("Event").listen(window,"scroll",b("debounceCore")(this._recordPYMKImpression.bind(this),100));b("Event").listen(window,"resize",b("debounceCore")(this._recordPYMKImpression.bind(this),100));b("Arbiter").subscribe("pymk-x-out",this._handleXout.bind(this));this._requestsBox=c;if(!this._requestsBox)return;this._lastRequestSeen=-1;this._recordFriendRequestImpression();b("Event").listen(window,"scroll",b("debounceCore")(this._recordFriendRequestImpression.bind(this),100));b("Event").listen(window,"resize",b("debounceCore")(this._recordFriendRequestImpression.bind(this),100))},_recordPYMKImpression:function(){__p&&__p();var a=b("DOM").scry(this._pymkBox,"li.friendBrowserListUnit"),c=b("Vector").getViewportDimensions().y,d=a.length-1;while(d>this._lastPymkSeen){var e=b("Vector").getElementPosition(a[d],"viewport").y;if(e>0&&e+b("Vector").getElementDimensions(a[d]).y<=c)break;d-=1}e=d;while(d>this._lastPymkSeen)this.logPYMKImpression(a[d],"friends_center"),d-=1;this._lastPymkSeen=Math.max(this._lastPymkSeen,e)},_recordFriendRequestImpression:function(){__p&&__p();var a=b("DOM").scry(this._requestsBox,"div.friendRequestItem"),c=b("Vector").getViewportDimensions().y,d=a.length-1;while(d>this._lastRequestSeen){var e=b("Vector").getElementPosition(a[d],"viewport").y;if(e>0&&e+b("Vector").getElementDimensions(a[d]).y<=c)break;d-=1}e=d;while(d>this._lastRequestSeen){c=a[d].getAttribute("data-id");var f={request_id:c,request_location:b("FriendRequestHowFound").FRIEND_CENTER_REQUESTS};b("MarauderLogger").log("request_seen","friend_request_waterfall",f);b("FriendRequestIHEventLogger").logImpression(c);d-=1}this._lastRequestSeen=Math.max(this._lastRequestSeen,e)},_handleXout:function(){this._lastPymkSeen=Math.max(this._lastPymkSeen-1,-1),this._recordPYMKImpression()},logPYMKImpression:function(a,c){var d=b("DOM").find(a,"input.friendBrowserID");d=parseInt(d.value,10);a=parseInt(a.getAttribute("data-signature"),10);b("PymkFunnelLogger").logImpression(d,a,c)}};e.exports=a}),null);
__d("JewelQPLogging",["QPRenderer"],(function(a,b,c,d,e,f){var g=!1,h=null,i=!1;function j(){if(i)return;g&&h&&(i=!0,b("QPRenderer").logEvent(String(h.promotion_id),"view",h.instance_log_data?h.instance_log_data:{}))}a={onJewelOpened:function(){g=!0,j()},updateQPLogData:function(a){h=a,j()}};e.exports=a}),null);
__d("RequestsJewelStore",["Arbiter","ArbiterMixin","ChannelConstants"],(function(a,b,c,d,e,f){__p&&__p();a=babelHelpers["extends"]({},b("ArbiterMixin"),{_initialized:!1,_count:0,_requestList:{},addFriendRequests:function(a){Object.assign(this._requestList,a)},getRequestListKeys:function(){return Object.keys(this._requestList)},removeRequest:function(a){delete this._requestList[a]},getRequestCount:function(a){return this.getRequestListKeys().length},decrementCount:function(){this.setCount(Math.max(0,this._count-1))},setCount:function(a){b("Arbiter").inform("jewel/count-updated",{jewel:"requests",count:a},"state")},setupListeners:function(){__p&&__p();var a=this;if(this._initialized)return;this._initialized=!0;b("Arbiter").subscribe("jewel/count-updated",function(b,c){c.jewel==="requests"&&a._updateCount(c.count)});b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("jewel_requests_add"),function(b,c){return a._addRequest(c)});b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("jewel_friending_notifs"),function(b,c){return a._addNotification(c)});b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("mobile_requests_count"),function(b,c){return a._updateBadgeCountFromObject(c)});b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("jewel_requests_remove_old"),function(b,c){return a._removeOldRequest(c)});b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("friend_requests_expired"),function(b,c){return a._refreshJewel(!0)});b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("friend_requests_seen"),function(b,c){return a.setCount(0)})},_updateCount:function(a){var b=this._count!==a;this._count=a;b&&this.inform("countUpdated",a)},_addRequest:function(a){__p&&__p();if(!a)return;a=a.obj;var b=a.from;a=a.suggester;b=this._requestList[b];b||this.setCount(this._count+1);b=b?b.type:null;a=b===19&&!a;this.inform("addRequest",{shouldReplace:a,previousType:b})},_updateBadgeCountFromObject:function(a){if(!a)return;a=a.obj;a=a.num_unseen+a.num_friend_confirmed_unseen+a.num_expire_highlight_unseen;this._refreshJewel();this.setCount(a)},_addNotification:function(a){if(!a||a.obj.notif_type!=="friend_confirmed")return;this.inform("addNotification")},_removeOldRequest:function(a){if(!a)return;a=this._requestList[a.obj.from];if(!a)return;this.inform("removeOldRequest",a)},_refreshJewel:function(a){a===void 0&&(a=!1),this.inform("refreshJewel",a)}});e.exports=a}),null);
__d("XExpireFriendRequestsMutationController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ajax/requests/expire/",{from_m_jewel:{type:"Bool",defaultValue:!1}})}),null);
__d("XGigaboxxUpdateSeenTimeAsyncController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ajax/gigaboxx/endpoint/writesafe/update_last_seen_time/",{})}),null);
__d("RequestsJewelController",["invariant","Promise","Arbiter","AsyncRequest","CSS","DOM","DOMQuery","Event","EventProfiler","Focus","FriendRequestIHEventLogger","JewelQPLogging","MarauderLogger","Parent","RequestsJewelStore","ScrollableArea","TimeSlice","WebFriendingRequests","XExpireFriendRequestsMutationController","XGigaboxxUpdateSeenTimeAsyncController","ge","getElementPosition","getViewportDimensions","promiseDone","requireWeak","throttle"],(function(a,b,c,d,e,f,g){__p&&__p();var h=null;b("requireWeak")("FriendBrowserCheckboxController",function(a){return h=a});var i=31,j=600,k=30,l=160;a=function(){"use strict";__p&&__p();a.getInstance=function(){return this.$11};a.updateFromDOM=function(){var a=this.getInstance();a&&a.fromDom()};a.setupScroll=function(){var a=this.getInstance();a&&a.setupScroll()};a.setInitialHeight=function(){var a=this.getInstance();a&&a.updateHeight()};a.maybeLoadJewel=function(){var a=this.getInstance();a&&a.maybeLoadJewel()};a.isOpen=function(){var a=this.getInstance();return a?a.$2():!1};a.create=function(b,c){this.$11&&g(0,5550);return this.$11=new a(b,c)};a.setupJewelRefresh=function(){b("Arbiter").subscribe(["FriendRequest/confirmFromProfile","FriendRequest/deleteFromProfile"],function(a,c){a={};a.reloadcontent=!0;new(b("AsyncRequest"))().setURI("/ajax/requests/loader/").setData(a).setAllowCrossPageTransition(!0).send()})};function a(a,c){__p&&__p();var d=this;this.$2=c;this.$1=a;this.$4=-1;this.$5=-1;this.$10=b("Promise").resolve(!0);this.$8=function(a){var c=this;b("throttle").acrossTransitionsWithBlocking(function(){return c.$12(a)},5e3)()};b("RequestsJewelStore").subscribe("addRequest",this.$13.bind(this));b("RequestsJewelStore").subscribe("addNotification",function(){return d.$14()});b("RequestsJewelStore").subscribe("removeOldRequest",this.$15.bind(this));b("RequestsJewelStore").subscribe("refreshJewel",this.$16.bind(this));b("RequestsJewelStore").setupListeners();this.setupScroll();this.$17();this.$18();this.$19()}var c=a.prototype;c.fromDom=function(){var a=this,c={};b("DOMQuery").scry(this.$1,"li.objectListItem").forEach(function(b){b=b.getAttribute("id");if(b){b=a.$20(b);b&&b.requester&&(c[b.requester]=b)}});b("RequestsJewelStore").addFriendRequests(c);this.$21()};c.maybeLoadJewel=function(){var a=this;this.$9&&(this.$9(function(){a.openHandler()}),this.$9=null)};c.updateHeight=function(){var a=this.$22();a&&(a.style.height=this.$23()+"px")};c.markSeen=function(){b("promiseDone")(this.$10,function(){new(b("AsyncRequest"))(b("XGigaboxxUpdateSeenTimeAsyncController").getURIBuilder().getURI()).setMethod("POST").send()})};c.openHandler=function(){__p&&__p();!this.$6&&this.$2()&&(this.$6=!0,b("EventProfiler").tagCurrentActiveInteractionsAs("FirstRequestsJewelOpen"));b("Arbiter").inform("requestsJewel/opened");var a=b("ge")("fbRequestsJewelLoading"),c=this.$22();new(b("AsyncRequest"))().setURI(b("XExpireFriendRequestsMutationController").getURIBuilder().getURI()).send();if(!a&&!c)this.$9=b("TimeSlice").getGuardedContinuation("RequestsJewelController clickBeforeE2E continuation");else if(a)this.$8({log_impressions:!0});else{a=b("RequestsJewelStore").getRequestListKeys();a.length>0&&new(b("AsyncRequest"))().setAllowCrossPageTransition(!0).setURI("/friends/requests/log_impressions").setData({ids:a.join(","),ref:"jewel"}).send()}b("DOMQuery").scry(this.$1,"a.findFriendsLink").forEach(function(a){b("Focus").set(a)});c&&b("ScrollableArea").poke(c);b("JewelQPLogging").onJewelOpened()};c.closeHandler=function(){b("Arbiter").inform("requestsJewel/closed"),b("DOMQuery").scry(this.$1,"li.jewelItemNew").forEach(function(a){b("CSS").removeClass(a,"jewelItemNew")}),b("DOMQuery").scry(this.$1,"span.highlightedExpireText").forEach(function(a){b("CSS").removeClass(a,"highlightedExpireText")})};c.setupScroll=function(){var a=this.$22();a&&(this.$7=this.$24(),this.$3=0,b("ScrollableArea").getInstance(a).subscribe("scroll",this.$25.bind(this)),this.$26(),this.$27())};c.$17=function(){b("Event").listen(this.$1,"submit",function(a){a=b("Parent").byClass(a.getTarget(),"objectListItem");a&&(b("CSS").removeClass(a,"jewelItemNew"),b("CSS").addClass(a,"jewelItemResponded"))})};c.$18=function(){var a=this;b("Event").listen(window,"resize",b("throttle").acrossTransitions(function(){a.updateHeight()}))};c.$19=function(){var a=this;b("Arbiter").subscribe("pymk-x-out",function(b,c){b=c.location;(b==="pymk_jewel_first_page"||b==="pymk_jewel")&&a.$26()})};c.$28=function(a){a=parseInt(a,10);return isNaN(a)?null:a};c.$20=function(a){a=a.match(/^(\d+)_(\d+)/);return!a?null:{requester:this.$28(a[1]),type:this.$28(a[2])}};c.$29=function(a,b){return a==null||b==null?null:a+"_"+b};c.$30=function(a,b){return a==null||b==null?null:a+"_"+b+"_req"};a.$31=function(a){a=a.getAttribute("id");return a.substring(0,a.length-6)};c.$22=function(){return b("DOMQuery").scry(this.$1,".uiScrollableArea")[0]};c.$24=function(){return b("DOMQuery").scry(this.$1,".uiScrollableAreaWrap")[0]};c.$25=function(){__p&&__p();var a=b("DOMQuery").scry(this.$7,".uiMorePager").pop();if(a){var c=b("getElementPosition")(a).y,d=this.$22();c>0&&d&&b("CSS").addClass(d,"contentAfter");c=b("DOMQuery").find(a,"a");if(!c)return;d=b("getElementPosition")(c).y;if(d===this.$3)return;a=b("getElementPosition")(this.$7);a=a.y+a.height;if(d-300<a&&d>0){this.$3=d;a=c.getAttribute("ajaxify");a?new(b("AsyncRequest"))(a).setRelativeTo(c).setStatusElement(b("Parent").byClass(c,"stat_elem")).send():h&&h.getInstance("jewel").showMore()}}this.$26();this.$27()};c.$26=function(){__p&&__p();if(!this.$7)return;var a=b("getElementPosition")(this.$7);a=a.y+a.height;var c=b("DOMQuery").scry(this.$1,"li.friendBrowserListUnit"),d=c.length-1;while(d>this.$4){var e=b("getElementPosition")(c[d]),f=e.y;e=f+e.height;if(f>0&&e<=a)break;d-=1}f=d;while(d>this.$4)b("WebFriendingRequests").logPYMKImpression(c[d],"pymk_jewel"),d--;this.$4=Math.max(this.$4,f)};c.$27=function(){__p&&__p();if(!this.$7)return;var c=b("getElementPosition")(this.$7);c=c.y+c.height;var d=b("DOMQuery").scry(this.$1,"li.objectListItem"),e=d.length-1;while(e>this.$5){var f=b("getElementPosition")(d[e]),g=f.y;f=g+f.height;if(g>0&&f<=c)break;e-=1}g=e;while(e>this.$5){f=a.$31(d[e]);b("MarauderLogger").log("request_seen","friend_request_waterfall",{request_id:f,request_location:"requests_jewel"});b("FriendRequestIHEventLogger").logImpression(f);e-=1}this.$5=Math.max(this.$5,g)};c.$12=function(a){a===void 0&&(a={}),this.$10=new(b("Promise"))(function(c,d){var e=!b("ge")("fbRequestsJewelLoading");new(b("AsyncRequest"))().setURI("/ajax/requests/loader/").setData(babelHelpers["extends"]({},a,{reloadcontent:e})).setFinallyHandler(function(a){!a.getError()?c(!0):d()}).send()})};c.$14=function(){if(this.$2())return;this.$8()};c.$13=function(a,b){a=b.shouldReplace;b=b.previousType;if(!a&&(b||this.$2()))return;this.$8()};c.$15=function(a,c){a=c.requester;c=c.type;if(this.$2()||b("ge")("fbRequestsJewelLoading")!=null)return;var d=this.$29(a,c),e=d&&b("ge")(d);e||(d=this.$30(a,c),e=b("ge")(d));e&&(b("CSS").hasClass(e,"jewelItemNew")&&b("RequestsJewelStore").decrementCount(),b("CSS").hasClass(e,"jewelItemResponded")||(b("DOM").remove(e),b("RequestsJewelStore").removeRequest(a),this.$21()))};c.$16=function(a,b){if(b!==!0&&this.$2())return;this.$8()};c.$21=function(){b("DOMQuery").scry(this.$1,"li.empty").forEach(function(a){b("CSS").conditionShow(a,b("RequestsJewelStore").getRequestCount()<=0)})};c.$23=function(){return Math.min(Math.max(b("getViewportDimensions")().height-l,k),j)+i};return a}();a.$11=null;e.exports=a}),null);
__d("WaterfallMessageLifetimeTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(){__p&&__p();function a(){this.$1={}}var c=a.prototype;c.log=function(){b("GeneratedLoggerUtils").log("logger:WaterfallMessageLifetimeLoggerConfig",this.$1,b("Banzai").BASIC)};c.logVital=function(){b("GeneratedLoggerUtils").log("logger:WaterfallMessageLifetimeLoggerConfig",this.$1,b("Banzai").VITAL)};c.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:WaterfallMessageLifetimeLoggerConfig",this.$1,{signal:!0})};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setAttemptID=function(a){this.$1.attempt_id=a;return this};c.setDestService=function(a){this.$1.dest_service=a;return this};c.setDeviceID=function(a){this.$1.device_id=a;return this};c.setEventType=function(a){this.$1.event_type=a;return this};c.setIsBatch=function(a){this.$1.is_batch=a;return this};c.setIsGroup=function(a){this.$1.is_group=a;return this};c.setMessageID=function(a){this.$1.message_id=a;return this};c.setOfflineThreadingID=function(a){this.$1.offline_threading_id=a;return this};c.setPageID=function(a){this.$1.page_id=a;return this};c.setPushNotifID=function(a){this.$1.push_notif_id=a;return this};c.setReceiptID=function(a){this.$1.receipt_id=a;return this};c.setSenderID=function(a){this.$1.sender_id=a;return this};c.setServiceName=function(a){this.$1.service_name=a;return this};c.setSrcService=function(a){this.$1.src_service=a;return this};c.setThreadID=function(a){this.$1.thread_id=a;return this};c.setTime=function(a){this.$1.time=a;return this};c.setTimeStamp=function(a){this.$1.time_stamp=a;return this};c.setTopic=function(a){this.$1.topic=a;return this};c.setWeight=function(a){this.$1.weight=a;return this};c.updateExtraData=function(a){a=b("nullthrows")(b("GeneratedLoggerUtils").serializeMap(a));b("GeneratedLoggerUtils").checkExtraDataFieldNames(a,g);this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.addToExtraData=function(a,b){var c={};c[a]=b;return this.updateExtraData(c)};return a}();var g={attempt_id:!0,dest_service:!0,device_id:!0,event_type:!0,is_batch:!0,is_group:!0,message_id:!0,offline_threading_id:!0,page_id:!0,push_notif_id:!0,receipt_id:!0,sender_id:!0,service_name:!0,src_service:!0,thread_id:!0,time:!0,time_stamp:!0,topic:!0,weight:!0};e.exports=a}),null);
__d("MercurySyncResnapshot",["Promise","Bootloader","MercurySingletonProvider"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(){__p&&__p();function a(a){this.$2=a}a.getForFBID=function(a){return g.getForFBID(a)};a.get=function(){return g.get()};var c=a.prototype;c.resnapshot=function(){var a=this;this.$1||(this.$1=new(b("Promise"))(function(c,d){b("Bootloader").loadModules(["MercurySyncDeltaHandler"],function(b){b.getForFBID(a.$2).emergencyDFF(function(b){c(b),a.$1=null},function(){d(),a.$1=null})},"MercurySyncResnapshot")}));return this.$1};return a}();var g=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("MessageWaterfallLogger",["MqttEnv","WaterfallMessageLifetimeTypedLogger"],(function(a,b,c,d,e,f){"use strict";var g=b("MqttEnv").Env,h=b("MqttEnv").MqttGkNames;a={logNewMessageToWaterfall:function(a){var c=a.senderID,d=a.receiptID,e=a.messageID,f=a.offlineThreadingID,i=a.threadID,j=a.irisSeqId;a=a.isGroup;if(!g.genGk(h.mqtt_waterfall_log_client_sampling))return;new(b("WaterfallMessageLifetimeTypedLogger"))().setEventType("message_receive_ws").setSrcService("mqtt").setDestService("webclient").setSenderID(c).setReceiptID(d).setMessageID(e).setOfflineThreadingID(f).setThreadID(i).setIsGroup(a?1:0).addToExtraData("sync_seq_id",j).log()}};e.exports=a}),null);
__d("MessengerMQTTPayloadPreprocessor",[],(function(a,b,c,d,e,f){"use strict";a={process:function(a,b,c){var d=parseInt(c.irisSeqId.toString(),10);return{seqID:d,obj:{queue:a,iseq:d,delta:c,seqID:d,type:b}}}};e.exports=a}),null);
__d("MessengerMQTTPresence",["BanzaiODS","FBMqttChannel","PresenceStatus","gkx"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g="/orca_presence",h="mqtt_web.presence",i="/send_additional_contacts",j=!1;a={subscribe:function(){if(j)return;j=!0;b("FBMqttChannel").subscribe(g,function(a){a=JSON.parse(a);a&&a.list&&(b("gkx")("983392")&&a.list_type&&a.list_type==="full"&&b("PresenceStatus").reset(),b("PresenceStatus").setMultiFromMQTT(a.list),b("BanzaiODS").bumpEntityKey(2966,h,"buddylist.event"),b("BanzaiODS").bumpEntityKey(2966,h,"buddylist.active_buddies",a.list.length))})},unsubscribe:function(){j=!1,b("FBMqttChannel").unsubscribe(g)},sendAdditionalBuddyRequest:function(a){b("FBMqttChannel").publish(i,JSON.stringify({additional_contacts:[a]}))}};e.exports=a}),null);
__d("MessengerMQTTPresenceReporting",["BanzaiODS","FBMqttChannel","InstantGamesPresenceProperties","MercuryConfig"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g="mqtt_web.presence",h="/foreground_state",i="/set_client_settings",j="/send_endpoint_capabilities",k=16384,l=2097152,m=b("MercuryConfig").idle_limit||18e5;a=b("MercuryConfig").idle_poll_interval||3e5;c=60*1e3;var n=document.hasFocus(),o,p=Date.now(),q=!1;d={init:function(){},reportForegroundState:function(a,c){(n!==a||c)&&(n=a,b("FBMqttChannel").setForegroundState(a),b("FBMqttChannel").publish(h,JSON.stringify({foreground:a})),b("BanzaiODS").bumpEntityKey(2966,g,a?"report.foregrounded":"report.backgrounded"))},reportChatVisibility:function(a){(o===void 0||o!=a)&&(o=a,b("FBMqttChannel").setChatVisibility(a),b("FBMqttChannel").publish(i,JSON.stringify({make_user_available_when_in_foreground:a})),b("BanzaiODS").bumpEntityKey(2966,g,a?"report.chat_visibility.on":"report.chat_visibility.off"))},reportWorkchatDesktopCapability:function(){var a=b("FBMqttChannel").getEndpointCapabilities();a|=k;b("FBMqttChannel").setEndpointCapabilities(a);b("FBMqttChannel").publish(j,JSON.stringify({endpoint_capabilities:a}))},reportInstantGamesPresence:function(a){var c=b("FBMqttChannel").getEndpointCapabilities();a?c|=l:c&=~l;b("FBMqttChannel").setEndpointCapabilities(c);b("FBMqttChannel").publish(j,JSON.stringify({endpoint_capabilities:c}))},onUserActivity:function(){p=Date.now(),e.exports.reportForegroundState(!0,!1)}};window.setInterval(function(){!document.hasFocus()&&Date.now()-p>m&&e.exports.reportForegroundState(!1,!0)},a);window.setInterval(function(){var a=b("InstantGamesPresenceProperties").isActiveGamePresence();q!==a&&(e.exports.reportInstantGamesPresence(a),q=a)},c);e.exports=d}),null);
__d("MessengerMQTTPresenceActivity",["CurrentUser","Event","MessengerMQTTPresenceReporting","Run","UserActivity"],(function(a,b,c,d,e,f){a={init:function(){b("Event").listen(window,"focus",function(){b("MessengerMQTTPresenceReporting").onUserActivity()}),b("Event").listen(window,"blur",function(){b("MessengerMQTTPresenceReporting").reportForegroundState(!1,!1)}),b("Run").onBeforeUnload(function(){b("MessengerMQTTPresenceReporting").reportForegroundState(!1,!0)},!1),b("UserActivity").subscribe(function(){b("MessengerMQTTPresenceReporting").onUserActivity()}),b("CurrentUser").isWorkUser()&&d(["WorkplaceChatHelper"],function(a){a.isDesktopChatApp()&&b("MessengerMQTTPresenceReporting").reportWorkchatDesktopCapability()})}};e.exports=a}),null);
__d("MessengerMQTTTypingDataPreProcessor",[],(function(a,b,c,d,e,f){"use strict";a={process:function(a,b){var c=b.thread;a=c==null?{from:b.sender_fbid,st:b.state,to:a,type:"typ"}:{from:b.sender_fbid,st:b.state,thread:c,thread_fbid:c,type:"ttyp"};return{obj:a}}};e.exports=a}),null);
__d("SyncProtocolClient",["Int64","MercurySingletonProvider","MqttEnv","SyncProtocolConstants","exponentialBackoff"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("MqttEnv").Env;a=function(){__p&&__p();a.getForFBID=function(a){return h.getForFBID(a)};function a(a){var c=this;this.$1=a;this.$2=[];this.$5=g.getLoggerInstance();this.$10=new(b("exponentialBackoff"))(function(){return c.$11()},this)}var c=a.prototype;c.getPublishMessages=function(){return this.$12()};c.init=function(a,c,d,e){__p&&__p();var f=this;if(!c&&!e){this.$5.bumpCounter("sp_init_invalid_parameter");return this}this.$9=a;this.$8=!0;this.$3=c?b("Int64").fromString(c):null;this.$6=d;this.$7=e;this.$4=null;this.$9.subscribe("/t_ms",function(a){return f.$13(a)});this.$9.subscribe("/thread_typing",function(a){f.$14(a)});this.$9.subscribe("/orca_typing_notifications",function(a){f.$14(a)});this.$9.subscribe("/notify_disconnect",function(a){return f.$15(a)});this.connectToIris();return this};c.connectToIris=function(a){a===void 0&&(a=null),a!==null&&(this.$3=b("Int64").fromString(a)),this.$8=!0,this.$9.registerExtraConnectPayloadProvider(this)};c.$12=function(){__p&&__p();var a;if(this.$4){if(!this.$3){this.$5.bumpCounter("connect_payload_iris_no_seq_id");return[]}a=this.$16()}else a=this.$17();this.$5.debugTrace("Sending request with MQTT Connect",JSON.stringify({topic:a.topic,payload:a.payload}));return[a]};c.$11=function(){__p&&__p();var a;if(this.$4){if(!this.$3){this.$5.bumpCounter("subscribe_to_iris_no_seq_id");return}a=this.$16()}else a=this.$17();this.$5.debugTrace("Sending request",JSON.stringify({topic:a.topic,payload:a.payload}));this.$9.publish(a.topic,a.payload,{qos:1,skipBuffer:!0})};c.$18=function(a){var b=null;try{b=JSON.parse(a)}catch(a){this.$5.logError(a,"Unable to process data")}return b};c.$14=function(a){var b=this.$18(a);if(b==null){this.$5.logWarn("_processTypingData","Unable to process typing data");return}this.$2.forEach(function(a){typeof a.onTypingReceived==="function"&&a.onTypingReceived(b)})};c.addDeltaStreamListener=function(a){this.$2.push(a)};c.$15=function(a){this.$5.logWarn("_handleNotifyDisconnect","Disconnecting reason: "+a),this.$5.bumpCounter("notify_disconnect_"+a),a===b("SyncProtocolConstants").IRIS_CURSOR_LIMIT&&this.$19(a)};c.$19=function(a){this.$5.bumpCounter(a+"_request"),this.$4=null,this.$8=!1,this.$9.unregisterExtraConnectPayloadProvider(this),this.$2.forEach(function(b){return b.onStreamDisconnect(a)})};c.$13=function(a){a=this.$18(a);if(a==null){this.$5.logWarn("_processDeltas","Unable to process delta");return}var b={syncToken:a.syncToken,entityId:a.queueEntityId,errorCode:a.errorCode,firstSeqId:a.firstDeltaSeqId,lastSeqId:a.lastIssuedSeqId};this.$5.debugTrace("Sync data received",JSON.stringify(b));b=this.$1;a.queueEntityId!=null&&a.queueEntityId!=b?this.$5.bumpCounter("delta_for_other_fbid"):a.syncToken?this.$20(a):a.queueEntityId==null?this.$5.bumpCounter("no_fbid"):a.errorCode?this.$21(a.errorCode):this.$22(a)};c.$21=function(a){this.$5.bumpCounter("iris_queue_error."+a),this.$5.logWarn("_handleIrisError","Recevied an error code from sync protocol "+a),a==="ERROR_QUEUE_TEMPORARY_NOT_AVAILABLE"?this.$10():this.$19(a)};c.$20=function(a){var c=this,d=b("Int64").fromString(a.firstDeltaSeqId.toString());(this.$3===null||this.$3!=null&&!this.$3.equals(d))&&this.$5.bumpCounter("initial_sequence_id_mismatch");this.$4=a.syncToken;this.$3=d;this.$5.debugTrace("Sync token received",JSON.stringify({token:this.$4}));this.$9.subscribeChannelEvents({onMQTTStateChanged:function(a){a==="Connected"&&c.$10.reset()}})};c.$22=function(a){var c=a.deltas,d=this.$3;if(c&&d){var e=b("Int64").fromString(a.firstDeltaSeqId.toString());a=b("Int64").fromString(a.lastIssuedSeqId.toString());e.equals(d.add(b("Int64").ONE))?this.$23(e,a,c):e.compare(d)<0?(this.$5.bumpCounter("delta_batch_in_middle"),a.compare(d)>0&&this.$23(d.add(b("Int64").ONE),a,c)):(this.$5.bumpCounter("missing_deltas_get_diffs"),this.$11())}else this.$5.bumpCounter("process_deltas_invalid_state")};c.$23=function(a,c,d){__p&&__p();a=a;for(var e=0;e<d.length;e++){var f=d[e],g=f["class"]||"Missing",h={seqId:a.toString(),type:g,status:""},i=1;if(g!="Missing")try{i=this.$24(f,g,a,h)}catch(a){h.status="err:"+a.message}else h.status="no type",this.$5.bumpCounter("missing_delta_type");this.$5.debugTrace("onDeltaReceived",JSON.stringify(h));a=a.add(b("Int64").fromInt(i))}this.$3=c};c.$24=function(a,c,d,e){__p&&__p();var f=1,g="";c==="NoOp"&&(f=a.numNoOps||f,g+="n:"+f);a.irisSeqId||(a.irisSeqId=d.toString(),g+="missing seq id");var h=b("Int64").fromString(a.irisSeqId.toString())||d;h.equals(d)?g+=" seqId match":(g+=" seqId mismatch",this.$5.bumpCounter("seq_id_running_id_mismatch"));var i={type:c,payload:a};this.$2.forEach(function(a){return a.onDeltaReceived(i)});e.status=g;return f};c.$17=function(){var a={sync_api_version:10,max_deltas_able_to_process:1e3,delta_batch_size:500,encoding:"JSON",entity_fbid:this.$1,initial_titan_sequence_id:this.$3&&this.$3.toString(),device_params:this.$6,queue_position:this.$7};return{topic:"/messenger_sync_create_queue",payload:JSON.stringify(a),qos:1}};c.$16=function(){var a={sync_token:this.$4,sync_api_version:10,max_deltas_able_to_process:1e3,delta_batch_size:500,encoding:"JSON",entity_fbid:this.$1,last_seq_id:this.$3&&this.$3.toString()};return{topic:"/messenger_sync_get_diffs",payload:JSON.stringify(a),qos:1}};return a}();var h=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("MessengerMQTTConnection",["Arbiter","CurrentUser","FBMqttChannel","MercurySingletonProvider","MercurySyncResnapshot","MessageWaterfallLogger","MessengerMQTTConnectionEvents","MessengerMQTTPayloadPreprocessor","MessengerMQTTPresence","MessengerMQTTTypingDataPreProcessor","MqttLogger","SyncProtocolClient","SyncProtocolConstants","gkx","promiseDone"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("MessengerMQTTConnectionEvents").DELTA_EVENT,h=b("MessengerMQTTConnectionEvents").STREAM_CONNECT,i=b("MessengerMQTTConnectionEvents").STREAM_DISCONNECT,j=b("MessengerMQTTConnectionEvents").STREAM_CONNECTING,k=b("MessengerMQTTConnectionEvents").STATE_CONNECTING,l=b("MessengerMQTTConnectionEvents").STATE_DISCONNECTED,m=b("MessengerMQTTConnectionEvents").TYP;a=function(){__p&&__p();a.getForFBID=function(a){return n.getForFBID(a)};a.get=function(){return n.get()};function a(a){this.$1=a,this.$2=b("MqttLogger").getInstance()}a.setUp=function(c){__p&&__p();var e=c.fbid,f=c.irisSeqID;c.appID;c.endpoint;if(!e||!f)return;var g=b("MqttLogger").getInstance();if(!b("CurrentUser").isLoggedInNow()){g.debugTrace("run","User not logged in");g.bumpCounter("user_not_loggged_in");return}var h=a.getForFBID(e);a.addDeltaStream({fbid:e,irisSeqID:f});h.$3(b("FBMqttChannel").getConnectionState(),b("FBMqttChannel").getLongPollingStatus());b("FBMqttChannel").subscribeChannelEvents({onMQTTStateChanged:function(a){h.$3(a,b("FBMqttChannel").getLongPollingStatus())},onJSError:function(a){g.bumpCounter("mqtt_js_error")}});(b("gkx")("845715")||b("gkx")("845716"))&&b("MessengerMQTTPresence").subscribe();b("gkx")("845716")&&d(["MessengerMQTTPresenceActivity"],function(a){a.init()})};a.addDeltaStream=function(c){var d=c.fbid;c=c.irisSeqID;var e=a.getForFBID(d),f=null;b("gkx")("687751")&&(f={accept_pending_deltas:!0});b("SyncProtocolClient").getForFBID(d).init(b("FBMqttChannel"),c,f).addDeltaStreamListener(e)};var c=a.prototype;c.onDeltaReceived=function(a){var c=a.type;a=a.payload;try{c=="NewMessage"&&b("MessageWaterfallLogger").logNewMessageToWaterfall({senderID:a.messageMetadata.actorFbId,receiptID:this.$1,messageID:a.messageMetadata.messageId,offlineThreadingID:a.messageMetadata.offlineThreadingId,threadID:a.messageMetadata.threadKey.threadFbId!=null?a.messageMetadata.threadKey.threadFbId:"",irisSeqId:a.irisSeqId,isGroup:a.messageMetadata.threadKey.threadFbId!=null})}catch(a){this.$2.logError(a,"Unable to log to waterfall")}c=b("MessengerMQTTPayloadPreprocessor").process(this.$1,c,a);b("Arbiter").inform(g,c)};c.onStreamDisconnect=function(a){var c=this;if(a==="ERROR_QUEUE_LOST"||a==="ERROR_QUEUE_NOT_FOUND"||a==="ERROR_QUEUE_EXCEEDS_MAX_DELTAS"||a==="ERROR_QUEUE_UNDERFLOW"||a==="ERROR_QUEUE_OVERFLOW"){b("promiseDone")(b("MercurySyncResnapshot").getForFBID(this.$1).resnapshot(),function(a){b("SyncProtocolClient").getForFBID(c.$1).connectToIris(a.toString())},function(){b("Arbiter").inform(i,b("SyncProtocolConstants").SNAPSHOT_FAILURE)});return}a!==b("SyncProtocolConstants").IRIS_CURSOR_LIMIT&&this.$2.bumpCounter("unhandled_iris_error."+a);b("Arbiter").inform(i,a)};c.onTypingReceived=function(a){a=b("MessengerMQTTTypingDataPreProcessor").process(this.$1,a);b("Arbiter").inform(m,a)};c.$3=function(a,c){if(a=="Connected"||c=="LPActive"){b("Arbiter").inform(h);return}switch(a){case k:b("Arbiter").inform(j);break;case l:b("Arbiter").inform(i);break}};return a}();var n=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);